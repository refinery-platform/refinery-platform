{
  "$schema": "http://json-schema.org/draft-04/hyper-schema",
  "definitions": {
    "FileType": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "name": {
          "type": "string"
        }
      }
    },
    "FileRelationship": {
      "type": "object",
      "required": [
        "name",
        "value_type",
        "file_relationship"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "value_type": {
          "type": "string",
          "enum": [
            "PAIR",
            "LIST"
          ]
        },
        "input_files": {
          "type": "array",
          "minItems": 1,
          "items": {
            "$ref": "#/definitions/InputFile"
          }
        },
        "file_relationship": {
          "oneOf": [
            {"type": "array", "maxItems": 0},
            {"$ref": "#/definitions/FileRelationship"}
          ]
        }
      }
    },
    "InputFile": {
      "type": "object",
      "required": [
        "name",
        "description",
        "allowed_filetypes"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "allowed_filetypes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/FileType"
          }
        }
      }
    },
    "OutputFile": {
      "type": "object",
      "required": [
        "name",
        "description",
        "filetype"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "file_type": {
          "type": "object",
          "$ref": "#/definitions/FileType"
        }
      }
    },
    "Parameter": {
      "type": "object",
      "required": [
        "name",
        "description",
        "value_type",
        "default_value"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "description": {
          "type": "string"
        },
        "value_type": {
          "type": "string",
          "enum": [
            "INTEGER",
            "STRING",
            "BOOLEAN",
            "FLOAT",
            "GENOME_BUILD",
            "ATTRIBUTE",
            "FILE"
          ]
        },
        "default_value": {
          "type": "string"
        }
      }
    },
    "GalaxyToolParameter": {
      "type": "object",
      "required": [
        "galaxy_tool_id",
        "galaxy_workflow_step",
        "galaxy_tool_parameter"
      ],
      "properties": {
        "galaxy_tool_id": {
          "type": "string"
        },
        "galaxy_workflow_step": {
          "type": "string"
        },
        "galaxy_tool_parameter": {
          "type": "string"
        }
      }
   }
  },

  "type": "object",

  "required": [
    "name",
    "description",
    "tool_type",
    "file_relationship"
  ],
  "properties": {
    "name": {
      "type": "string"
    },
    "description": {
      "type": "string"
    },
    "tool_type": {
      "type": "string",
      "enum": [
        "WORKFLOW",
        "VISUALIZATION"
      ]
    },
    "file_relationship": {
      "$ref": "#/definitions/FileRelationship"
    },
    "output_files": {
      "type": "array",
      "items": {
       "$ref": "#/definitions/OutputFile"
      }
    },
    "parameters": {
      "type": "array",
      "items": {
       "$ref": "#/definitions/Parameter"
      }
    }
  }
}
